# Render Disk設定手順（データベース永続化）

## 問題
デプロイのたびにデータベースがリセットされ、ユーザーデータが消えてしまいます。

## 解決方法：Render Diskを追加

### ステップ1: Render Diskを追加

1. Renderダッシュボードにアクセス: https://dashboard.render.com
2. バックエンドサービス（`membership-site`）を開く
3. 「Settings」タブをクリック
4. 下にスクロールして「Disk」セクションを見つける
5. 「Add disk」ボタンをクリック

### ステップ2: Disk設定

以下の設定を入力：

- **Mount Path**: `/opt/render/project/src/server/data`
- **Size**: `1` GB（最小サイズ、無料プランでも使用可能）

### ステップ3: 保存と再デプロイ

1. 「Add disk」をクリック
2. 自動的に再デプロイが開始されます
3. デプロイ完了を待ちます（数分）

### ステップ4: 確認

デプロイ後、サーバーのログで以下が表示されることを確認：

```
データベースディレクトリ: /opt/render/project/src/server/data
データベースパス: /opt/render/project/src/server/data/members.db
Render環境: Yes
データベースに接続しました
既存のデータベースファイルを使用します
```

## 注意事項

- **無料プランでもDiskは使用可能**ですが、サイズ制限があります（1GB）
- Diskを追加すると、データベースファイルが永続化され、デプロイ後もデータが残ります
- Diskを追加しないと、デプロイのたびにデータがリセットされます

## トラブルシューティング

### Diskが追加できない場合

1. Renderの無料プランでDiskが使用できない場合は、有料プランへのアップグレードが必要です
2. または、環境変数`DATABASE_DIR`を設定して、別の永続化されたパスを指定できます

### データが消えた場合

1. Diskが正しくマウントされているか確認
2. サーバーログでデータベースパスを確認
3. Diskのサイズが不足していないか確認
